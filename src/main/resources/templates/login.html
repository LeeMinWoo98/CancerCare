<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>cancercare – 로그인</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root{
            --bg:#f7f9fc;
            --card:#ffffff;
            --text:#0b1a2b;
            --muted:#6b7280;
            --brand:#2563eb; /* blue-600 */
            --brand-700:#1d4ed8;
            --outline:#e5e7eb;
            --shadow:0 10px 30px rgba(2, 17, 79, .08);
            --radius:16px;
        }
        *{box-sizing:border-box}
        html,body{height:100%}
        body{margin:0;background:var(--bg);font-family:"Pretendard", system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans KR", sans-serif;color:var(--text)}
        .wrap{min-height:100%;display:grid;place-items:center;padding:40px 16px}

        .card{width:100%;max-width:420px;background:var(--card);border:1px solid var(--outline);border-radius:var(--radius);box-shadow:var(--shadow);padding:28px}
        .brand{display:flex;align-items:center;gap:10px;margin-bottom:6px}
        .logo{width:28px;height:28px;border-radius:50%;display:grid;place-items:center;background:linear-gradient(135deg,#4f46e5,#22d3ee);color:#fff;font-size:14px;font-weight:800}
        .subtitle{color:var(--muted);font-size:13px;margin-top:4px}

        h1{margin:10px 0 2px;font-size:24px;letter-spacing:-.01em}

        form{margin-top:18px}
        .field{margin-bottom:14px}
        label{display:block;font-weight:600;margin-bottom:8px}
        .req{color:#ef4444;margin-left:4px}
        input[type=text],input[type=password]{width:100%;height:44px;border:1px solid var(--outline);border-radius:10px;padding:0 12px;font-size:15px;outline:none;background:#fff}
        input[type=text]::placeholder,input[type=password]::placeholder{color:#9ca3af}
        input[type=text]:focus,input[type=password]:focus{border-color:#94b5ff;box-shadow:0 0 0 3px rgba(37,99,235,.12)}

        .hint{display:flex;justify-content:space-between;align-items:center;margin:8px 2px 14px}
        .remember{display:flex;align-items:center;gap:8px;color:#374151;font-size:14px}
        .remember input{width:16px;height:16px}

        .btn{width:100%;height:46px;border:none;border-radius:12px;background:var(--brand);color:#fff;font-weight:700;font-size:15px;cursor:pointer}
        .btn:hover{background:var(--brand-700)}

        .links{margin-top:14px;display:flex;gap:14px;justify-content:center;font-size:14px}
        .links a{color:#2563eb;text-decoration:none}
        .links a:hover{text-decoration:underline}

        .alert{margin-top:12px;border:1px solid #fecaca;background:#fef2f2;color:#991b1b;border-radius:10px;padding:10px 12px;font-size:14px}
        .err{color:#dc2626;font-size:12px;margin-top:6px}
    </style>
</head>
<body>
<div class="wrap">
    <div class="card">
        <!-- 로고 / 브랜드 -->
        <div class="brand">
            <div class="logo">A</div>
            <strong>cancercare</strong>
        </div>

        <!-- 타이틀 -->
        <h2>cancercare에 오신 것을 환영합니다</h2>
        <div class="subtitle">cancercare 계정에 로그인하세요</div>

        <!-- 로그인 폼 -->
        <form th:action="@{/login}" method="post">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
            <div class="field">
                <label for="username">아이디 <span class="req">*</span></label>
                <input id="username" name="username" type="text" placeholder="아이디를 입력하세요" required>
            </div>

            <div class="field">
                <label for="password">비밀번호 <span class="req">*</span></label>
                <input id="password" name="password" type="password" placeholder="비밀번호를 입력하세요" required>
            </div>


            <button class="btn" type="submit">로그인</button>
        </form>

        <div class="links">
            <a th:href="@{/signup}">회원가입</a>
            <span>·</span>
            <a th:href="@{/find}">ID/PW찾기</a>
        </div>
        
        <div th:if="${param.signup}" class="alert" style="background:#f0f9ff;color:#0369a1;border-color:#bae6fd;">
            회원가입이 완료되었습니다. 로그인해주세요.
        </div>
        
        <div th:if="${param.logout}" class="alert" style="background:#f0f9ff;color:#0369a1;border-color:#bae6fd;">
            로그아웃되었습니다.
        </div>
        
        <div th:if="${param.error}" class="alert">
            아이디 또는 비밀번호가 올바르지 않습니다.
        </div>
    </div>
</div>

<script>
// 로그인 오류 메시지를 Alert로 표시
window.addEventListener('load', function() {
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.has('error')) {
        alert('아이디 또는 비밀번호가 올바르지 않습니다.');
        // URL에서 error 파라미터 제거
        const url = new URL(window.location);
        url.searchParams.delete('error');
        window.history.replaceState({}, document.title, url.pathname + url.search);
    }
});
</script>
</body>
</html>
<!--
   <script th:inline="javascript">
   /*<![CDATA[*/
       // 아래는 JavaScript로 에러 메시지를 처리하는 예시입니다.
       // Spring Security는 로그인 실패 시 URL에 '?error' 파라미터를 추가하여 리디렉션합니다.
       // 이 파라미터의 존재 여부를 확인하여 에러 발생을 감지할 수 있습니다.
       const urlParams = new URLSearchParams(window.location.search);
       if (urlParams.has('error')) {
           const alertBox = document.querySelector('.alert');
           // 서버의 Thymeleaf가 이미 에러 메시지를 표시했을 수 있으므로,
           // alertBox 내부가 비어있을 때만 기본 메시지를 추가합니다.
           if (alertBox && !alertBox.textContent.trim()) {
               alertBox.innerHTML = '<span>이메일 또는 비밀번호가 올바르지 않습니다.</span>';
           }
       }
   /*]]>*/
   </script>
   -->